<%= render 'creatives/navbar' %>

<header id="header_city_omg">
  <div class="header-content">
    <div class="header-content-inner" id="title_cities">
      <h1><%= @city_name %></h1>
      <hr>
      <p>Listing all attractions for <%= @city_name %></p>
      <a href="#show_list" class="btn btn-primary btn-xl page-scroll">Go</a>
    </div>
  </div>
</header>

<div class="container">

  <div class="row">
    <div class="col-md-8">
      <section id="show_list">
        <table id="table_data" class="table table-striped table-bordered" cellspacing="0" width="100%">
          <thead>
          <tr>
            <th>Title</th>
            <th>Price</th>
            <th>Description</th>
          </tr>
          </thead>
          <tfoot>
          <tr>
            <th>Title</th>
            <th>Price</th>
            <th>Description</th>
          </tr>
          </tfoot>
        </table>
      </section>
    </div>

    <div class="col-md-4">
      <div class="row">
        <div class="col-md-12">
          <h3>News</h3>
        </div>
      </div>

      <div class="row">

        <div class="input-group">
          <input id="budget" type="number" class="form-control" name="budget" placeholder="Budget">
          <span class="input-group-addon"><i class="glyphicon glyphicon-usd"></i></span>
        </div>
        <div class="input-group">
          <input id="days" type="number" class="form-control" name="days" placeholder="Number of days for vacation">
          <span class="input-group-addon"><i class="glyphicon glyphicon-book"></i></span>
        </div>
        <br>
        <button onclick="executeorder66()" type="submit" class="btn btn-success btn-lg">
          <i class="fa fa-tasks"></i> Generate Schedule!
        </button>
        <p id="errorInForm"></p>

      </div>

    </div>
  </div>
</div>

<script>
    $(document).ready(function () {
        $('#table_data').DataTable({
            "processing": true,
            ajax: {
                "url": "https://pure-coast-27115.herokuapp.com/data/city/" + <%= @city_id %>
            },
            "columns":
                [
                    {data: "title"},
                    {
                        data: "price", render: function (data, type, row) {
                        if (type === 'display') {
                            var numberRenderer = $.fn.dataTable.render.number(',', '.', 0, '$').display;
                            return numberRenderer(data);
                        }
                        return data;
                    }
                    },
                    {
                        data: "id", render: function (data, type, row) {
                        return '<a href="https://pure-coast-27115.herokuapp.com/attraction_detail/' + data + '">Learn more <i class="fa fa-arrow-right" aria-hidden="true"></i></a>';
                    }
                    }
                ],
            "lengthMenu":
                [[15, 25, 50, 100, -1], [15, 25, 50, 100, "All"]]
        })
        ;
    });
</script>

<script type="text/javascript">

    function executeorder66() {
        var budget = document.getElementById('budget').value;
        var days = document.getElementById('days').value;

        if ((budget < 50) || (budget > 1000)) {
            document.getElementById('errorInForm').innerHTML = 'Please enter budget between $50 and $1000 only!';
        }

        if ((days < 0) || (days > 10)) {
            document.getElementById('errorInForm').innerHTML = 'Please enter days between 1 and 10 only!';
        } else {
            location.href = "https://pure-coast-27115.herokuapp.com/schedules/city/" + <%= @city_id %> +"/days/" + days + "/budget/" + budget;
//            location.href = "http://localhost:5000/schedules/city/" + <%= @city_id %> +"/days/" + days + "/budget/" + budget;
        }
    }
</script>
